{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/sivakotireddy20028883/telecom-customer-churn-using-ML-Models-with-86-accuracy/blob/main/ML-Models-with-86-accuracy1\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 1,
      "metadata": {
        "id": "GcBGT5MjRWGu"
      },
      "outputs": [],
      "source": [
        "import pandas as pd\n",
        "import numpy as np\n",
        "import matplotlib.pyplot as plt\n",
        "import seaborn as sns\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 2,
      "metadata": {
        "id": "PZVXo18uRmOV"
      },
      "outputs": [],
      "source": [
        "df=pd.read_csv(\"/content/WA_Fn-UseC_-Telco-Customer-Churn.csv\")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 3,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "QWHoQAnjRyrA",
        "outputId": "948f6186-7776-4c7a-a2b8-b23af16fd324"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "<class 'pandas.core.frame.DataFrame'>\n",
            "RangeIndex: 7043 entries, 0 to 7042\n",
            "Data columns (total 21 columns):\n",
            " #   Column            Non-Null Count  Dtype  \n",
            "---  ------            --------------  -----  \n",
            " 0   customerID        7043 non-null   object \n",
            " 1   gender            7043 non-null   object \n",
            " 2   SeniorCitizen     7043 non-null   int64  \n",
            " 3   Partner           7043 non-null   object \n",
            " 4   Dependents        7043 non-null   object \n",
            " 5   tenure            7043 non-null   int64  \n",
            " 6   PhoneService      7043 non-null   object \n",
            " 7   MultipleLines     7043 non-null   object \n",
            " 8   InternetService   7043 non-null   object \n",
            " 9   OnlineSecurity    7043 non-null   object \n",
            " 10  OnlineBackup      7043 non-null   object \n",
            " 11  DeviceProtection  7043 non-null   object \n",
            " 12  TechSupport       7043 non-null   object \n",
            " 13  StreamingTV       7043 non-null   object \n",
            " 14  StreamingMovies   7043 non-null   object \n",
            " 15  Contract          7043 non-null   object \n",
            " 16  PaperlessBilling  7043 non-null   object \n",
            " 17  PaymentMethod     7043 non-null   object \n",
            " 18  MonthlyCharges    7043 non-null   float64\n",
            " 19  TotalCharges      7043 non-null   object \n",
            " 20  Churn             7043 non-null   object \n",
            "dtypes: float64(1), int64(2), object(18)\n",
            "memory usage: 1.1+ MB\n"
          ]
        }
      ],
      "source": [
        "df.info()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 4,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 300
        },
        "id": "cO1UyCmjR6hr",
        "outputId": "bb0d910e-d63d-4351-845f-fe1f5c9bb9cf"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "       SeniorCitizen       tenure  MonthlyCharges\n",
              "count    7043.000000  7043.000000     7043.000000\n",
              "mean        0.162147    32.371149       64.761692\n",
              "std         0.368612    24.559481       30.090047\n",
              "min         0.000000     0.000000       18.250000\n",
              "25%         0.000000     9.000000       35.500000\n",
              "50%         0.000000    29.000000       70.350000\n",
              "75%         0.000000    55.000000       89.850000\n",
              "max         1.000000    72.000000      118.750000"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-a9edaec2-0ba0-4b18-9f02-08d06d9d4ac7\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>SeniorCitizen</th>\n",
              "      <th>tenure</th>\n",
              "      <th>MonthlyCharges</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>count</th>\n",
              "      <td>7043.000000</td>\n",
              "      <td>7043.000000</td>\n",
              "      <td>7043.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>mean</th>\n",
              "      <td>0.162147</td>\n",
              "      <td>32.371149</td>\n",
              "      <td>64.761692</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>std</th>\n",
              "      <td>0.368612</td>\n",
              "      <td>24.559481</td>\n",
              "      <td>30.090047</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>min</th>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>18.250000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>25%</th>\n",
              "      <td>0.000000</td>\n",
              "      <td>9.000000</td>\n",
              "      <td>35.500000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>50%</th>\n",
              "      <td>0.000000</td>\n",
              "      <td>29.000000</td>\n",
              "      <td>70.350000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>75%</th>\n",
              "      <td>0.000000</td>\n",
              "      <td>55.000000</td>\n",
              "      <td>89.850000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>max</th>\n",
              "      <td>1.000000</td>\n",
              "      <td>72.000000</td>\n",
              "      <td>118.750000</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a9edaec2-0ba0-4b18-9f02-08d06d9d4ac7')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-a9edaec2-0ba0-4b18-9f02-08d06d9d4ac7 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-a9edaec2-0ba0-4b18-9f02-08d06d9d4ac7');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-ec4f5a65-da39-4ebd-8a9d-eea2e1efb35b\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-ec4f5a65-da39-4ebd-8a9d-eea2e1efb35b')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-ec4f5a65-da39-4ebd-8a9d-eea2e1efb35b button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "summary": "{\n  \"name\": \"df\",\n  \"rows\": 8,\n  \"fields\": [\n    {\n      \"column\": \"SeniorCitizen\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2489.9992387084,\n        \"min\": 0.0,\n        \"max\": 7043.0,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          0.1621468124378816,\n          1.0,\n          0.36861160561002687\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"tenure\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2478.9752758409018,\n        \"min\": 0.0,\n        \"max\": 7043.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          32.37114865824223,\n          29.0,\n          7043.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"MonthlyCharges\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2468.7047672837775,\n        \"min\": 18.25,\n        \"max\": 7043.0,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          64.76169246059918,\n          70.35,\n          7043.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 4
        }
      ],
      "source": [
        "df.describe()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 5,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 342
        },
        "id": "jAvSBnjGSDyS",
        "outputId": "13bef7e9-c995-4279-d45c-30a5f3ad8fb4"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "   customerID  gender  SeniorCitizen Partner Dependents  tenure PhoneService  \\\n",
              "0  7590-VHVEG  Female              0     Yes         No       1           No   \n",
              "1  5575-GNVDE    Male              0      No         No      34          Yes   \n",
              "2  3668-QPYBK    Male              0      No         No       2          Yes   \n",
              "3  7795-CFOCW    Male              0      No         No      45           No   \n",
              "4  9237-HQITU  Female              0      No         No       2          Yes   \n",
              "\n",
              "      MultipleLines InternetService OnlineSecurity  ... DeviceProtection  \\\n",
              "0  No phone service             DSL             No  ...               No   \n",
              "1                No             DSL            Yes  ...              Yes   \n",
              "2                No             DSL            Yes  ...               No   \n",
              "3  No phone service             DSL            Yes  ...              Yes   \n",
              "4                No     Fiber optic             No  ...               No   \n",
              "\n",
              "  TechSupport StreamingTV StreamingMovies        Contract PaperlessBilling  \\\n",
              "0          No          No              No  Month-to-month              Yes   \n",
              "1          No          No              No        One year               No   \n",
              "2          No          No              No  Month-to-month              Yes   \n",
              "3         Yes          No              No        One year               No   \n",
              "4          No          No              No  Month-to-month              Yes   \n",
              "\n",
              "               PaymentMethod MonthlyCharges  TotalCharges Churn  \n",
              "0           Electronic check          29.85         29.85    No  \n",
              "1               Mailed check          56.95        1889.5    No  \n",
              "2               Mailed check          53.85        108.15   Yes  \n",
              "3  Bank transfer (automatic)          42.30       1840.75    No  \n",
              "4           Electronic check          70.70        151.65   Yes  \n",
              "\n",
              "[5 rows x 21 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-0a3f0f72-06d0-4416-a02d-c819dac05808\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>customerID</th>\n",
              "      <th>gender</th>\n",
              "      <th>SeniorCitizen</th>\n",
              "      <th>Partner</th>\n",
              "      <th>Dependents</th>\n",
              "      <th>tenure</th>\n",
              "      <th>PhoneService</th>\n",
              "      <th>MultipleLines</th>\n",
              "      <th>InternetService</th>\n",
              "      <th>OnlineSecurity</th>\n",
              "      <th>...</th>\n",
              "      <th>DeviceProtection</th>\n",
              "      <th>TechSupport</th>\n",
              "      <th>StreamingTV</th>\n",
              "      <th>StreamingMovies</th>\n",
              "      <th>Contract</th>\n",
              "      <th>PaperlessBilling</th>\n",
              "      <th>PaymentMethod</th>\n",
              "      <th>MonthlyCharges</th>\n",
              "      <th>TotalCharges</th>\n",
              "      <th>Churn</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>7590-VHVEG</td>\n",
              "      <td>Female</td>\n",
              "      <td>0</td>\n",
              "      <td>Yes</td>\n",
              "      <td>No</td>\n",
              "      <td>1</td>\n",
              "      <td>No</td>\n",
              "      <td>No phone service</td>\n",
              "      <td>DSL</td>\n",
              "      <td>No</td>\n",
              "      <td>...</td>\n",
              "      <td>No</td>\n",
              "      <td>No</td>\n",
              "      <td>No</td>\n",
              "      <td>No</td>\n",
              "      <td>Month-to-month</td>\n",
              "      <td>Yes</td>\n",
              "      <td>Electronic check</td>\n",
              "      <td>29.85</td>\n",
              "      <td>29.85</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>5575-GNVDE</td>\n",
              "      <td>Male</td>\n",
              "      <td>0</td>\n",
              "      <td>No</td>\n",
              "      <td>No</td>\n",
              "      <td>34</td>\n",
              "      <td>Yes</td>\n",
              "      <td>No</td>\n",
              "      <td>DSL</td>\n",
              "      <td>Yes</td>\n",
              "      <td>...</td>\n",
              "      <td>Yes</td>\n",
              "      <td>No</td>\n",
              "      <td>No</td>\n",
              "      <td>No</td>\n",
              "      <td>One year</td>\n",
              "      <td>No</td>\n",
              "      <td>Mailed check</td>\n",
              "      <td>56.95</td>\n",
              "      <td>1889.5</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>3668-QPYBK</td>\n",
              "      <td>Male</td>\n",
              "      <td>0</td>\n",
              "      <td>No</td>\n",
              "      <td>No</td>\n",
              "      <td>2</td>\n",
              "      <td>Yes</td>\n",
              "      <td>No</td>\n",
              "      <td>DSL</td>\n",
              "      <td>Yes</td>\n",
              "      <td>...</td>\n",
              "      <td>No</td>\n",
              "      <td>No</td>\n",
              "      <td>No</td>\n",
              "      <td>No</td>\n",
              "      <td>Month-to-month</td>\n",
              "      <td>Yes</td>\n",
              "      <td>Mailed check</td>\n",
              "      <td>53.85</td>\n",
              "      <td>108.15</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>7795-CFOCW</td>\n",
              "      <td>Male</td>\n",
              "      <td>0</td>\n",
              "      <td>No</td>\n",
              "      <td>No</td>\n",
              "      <td>45</td>\n",
              "      <td>No</td>\n",
              "      <td>No phone service</td>\n",
              "      <td>DSL</td>\n",
              "      <td>Yes</td>\n",
              "      <td>...</td>\n",
              "      <td>Yes</td>\n",
              "      <td>Yes</td>\n",
              "      <td>No</td>\n",
              "      <td>No</td>\n",
              "      <td>One year</td>\n",
              "      <td>No</td>\n",
              "      <td>Bank transfer (automatic)</td>\n",
              "      <td>42.30</td>\n",
              "      <td>1840.75</td>\n",
              "      <td>No</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>9237-HQITU</td>\n",
              "      <td>Female</td>\n",
              "      <td>0</td>\n",
              "      <td>No</td>\n",
              "      <td>No</td>\n",
              "      <td>2</td>\n",
              "      <td>Yes</td>\n",
              "      <td>No</td>\n",
              "      <td>Fiber optic</td>\n",
              "      <td>No</td>\n",
              "      <td>...</td>\n",
              "      <td>No</td>\n",
              "      <td>No</td>\n",
              "      <td>No</td>\n",
              "      <td>No</td>\n",
              "      <td>Month-to-month</td>\n",
              "      <td>Yes</td>\n",
              "      <td>Electronic check</td>\n",
              "      <td>70.70</td>\n",
              "      <td>151.65</td>\n",
              "      <td>Yes</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>5 rows × 21 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-0a3f0f72-06d0-4416-a02d-c819dac05808')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-0a3f0f72-06d0-4416-a02d-c819dac05808 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-0a3f0f72-06d0-4416-a02d-c819dac05808');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-54c35f26-0811-4032-b344-3454d18b53e1\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-54c35f26-0811-4032-b344-3454d18b53e1')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-54c35f26-0811-4032-b344-3454d18b53e1 button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "df"
            }
          },
          "metadata": {},
          "execution_count": 5
        }
      ],
      "source": [
        "df.head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 6,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 411
        },
        "id": "RvAEpCZBXDHL",
        "outputId": "181caaa6-ff1b-4dd3-8d6c-693155cc2b14"
      },
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<Figure size 640x480 with 1 Axes>"
            ],
            "image/png": "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\n"
          },
          "metadata": {}
        }
      ],
      "source": [
        "import matplotlib.pyplot as plt\n",
        "import seaborn as sns\n",
        "\n",
        "# Visualize box plots for numerical columns\n",
        "\n",
        "sns.boxplot(df['MonthlyCharges'])\n",
        "sns.boxplot(df['TotalCharges'])\n",
        "plt.show()\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 7,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 742
        },
        "id": "Ls1OyBYPXnNA",
        "outputId": "c7ba8140-d10b-4508-9638-cdccadce4617"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "customerID          0\n",
              "gender              0\n",
              "SeniorCitizen       0\n",
              "Partner             0\n",
              "Dependents          0\n",
              "tenure              0\n",
              "PhoneService        0\n",
              "MultipleLines       0\n",
              "InternetService     0\n",
              "OnlineSecurity      0\n",
              "OnlineBackup        0\n",
              "DeviceProtection    0\n",
              "TechSupport         0\n",
              "StreamingTV         0\n",
              "StreamingMovies     0\n",
              "Contract            0\n",
              "PaperlessBilling    0\n",
              "PaymentMethod       0\n",
              "MonthlyCharges      0\n",
              "TotalCharges        0\n",
              "Churn               0\n",
              "dtype: int64"
            ],
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>0</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>customerID</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>gender</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>SeniorCitizen</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>Partner</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>Dependents</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>tenure</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>PhoneService</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>MultipleLines</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>InternetService</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>OnlineSecurity</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>OnlineBackup</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>DeviceProtection</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>TechSupport</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>StreamingTV</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>StreamingMovies</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>Contract</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>PaperlessBilling</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>PaymentMethod</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>MonthlyCharges</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>TotalCharges</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>Churn</th>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div><br><label><b>dtype:</b> int64</label>"
            ]
          },
          "metadata": {},
          "execution_count": 7
        }
      ],
      "source": [
        "df.isnull().sum()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 8,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "mGdW7TLeohJA",
        "outputId": "338f82a7-a3c2-486d-c84e-687012df1331"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "<ipython-input-8-e191b56f00c2>:10: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.\n",
            "The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.\n",
            "\n",
            "For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.\n",
            "\n",
            "\n",
            "  df['TotalCharges'].fillna(df['TotalCharges'].mean(), inplace=True)\n"
          ]
        }
      ],
      "source": [
        "# ... (your previous code for loading and initial cleaning) ...\n",
        "\n",
        "# 1. Convert 'TotalCharges' to numeric\n",
        "df['TotalCharges'] = pd.to_numeric(df['TotalCharges'], errors='coerce')\n",
        "\n",
        "# 2. Impute or drop missing values\n",
        "# Choose one of the following methods:\n",
        "\n",
        "# A. Impute missing values using the mean\n",
        "df['TotalCharges'].fillna(df['TotalCharges'].mean(), inplace=True)\n",
        "\n",
        "# OR\n",
        "\n",
        "# B. Drop rows with missing values\n",
        "# df.dropna(inplace=True)\n",
        "\n",
        "# ... (rest of your code: one-hot encoding, scaling, train-test split, model training) ..."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 9,
      "metadata": {
        "id": "cGOt9rrKXp99"
      },
      "outputs": [],
      "source": [
        "from logging import error\n",
        "df['TotalCharges']=pd.to_numeric(df['TotalCharges'], errors='coerce')\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 10,
      "metadata": {
        "id": "QX9sjk4dYU7E"
      },
      "outputs": [],
      "source": [
        "from sklearn.preprocessing import LabelEncoder\n",
        "\n",
        "label_encoder = LabelEncoder()\n",
        "df['gender'] = label_encoder.fit_transform(df['gender'])\n",
        "df['Partner'] = label_encoder.fit_transform(df['Partner'])\n",
        "df['Dependents'] = label_encoder.fit_transform(df['Dependents'])\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 11,
      "metadata": {
        "id": "LsiC6lSaZHX8"
      },
      "outputs": [],
      "source": [
        "df = pd.get_dummies(df, drop_first=True)  # drop_first=True to avoid multicollinearity\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 12,
      "metadata": {
        "id": "hPA0kLmJZKOT"
      },
      "outputs": [],
      "source": [
        "from sklearn.preprocessing import StandardScaler\n",
        "\n",
        "scaler = StandardScaler()\n",
        "df[['tenure', 'MonthlyCharges', 'TotalCharges']] = scaler.fit_transform(df[['tenure', 'MonthlyCharges', 'TotalCharges']])\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 13,
      "metadata": {
        "id": "tZsfpPhQpALj"
      },
      "outputs": [],
      "source": [
        "from sklearn.model_selection import train_test_split\n",
        "\n",
        "# Separate features (X) and target variable (y)\n",
        "# Check if 'customerID' is present in its original form or prefixed\n",
        "customerID_col = next((col for col in df.columns if col.startswith('customerID')), 'customerID')\n",
        "# 'Churn' has been one-hot encoded and 'Churn_No' might have been dropped due to drop_first=True.\n",
        "# So, the target variable is now 'Churn_Yes' if it exists, otherwise it's 'Churn'\n",
        "target_col = 'Churn_Yes' if 'Churn_Yes' in df.columns else 'Churn'  # Check for 'Churn_Yes' first\n",
        "# only drop the 'customerID' column\n",
        "X = df.drop(columns=[customerID_col])\n",
        "y = df[target_col]  # Use the determined target column\n",
        "\n",
        "# Split the data into training and testing sets\n",
        "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 13,
      "metadata": {
        "id": "T6Wn9EmYofGT"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "jFdgSbOnsjPD"
      },
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": 14,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 80
        },
        "id": "Irbm8rLaoQA4",
        "outputId": "fc1284a7-22b9-4fc1-e3f0-1e6628109bf9"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "LogisticRegression()"
            ],
            "text/html": [
              "<style>#sk-container-id-1 {\n",
              "  /* Definition of color scheme common for light and dark mode */\n",
              "  --sklearn-color-text: #000;\n",
              "  --sklearn-color-text-muted: #666;\n",
              "  --sklearn-color-line: gray;\n",
              "  /* Definition of color scheme for unfitted estimators */\n",
              "  --sklearn-color-unfitted-level-0: #fff5e6;\n",
              "  --sklearn-color-unfitted-level-1: #f6e4d2;\n",
              "  --sklearn-color-unfitted-level-2: #ffe0b3;\n",
              "  --sklearn-color-unfitted-level-3: chocolate;\n",
              "  /* Definition of color scheme for fitted estimators */\n",
              "  --sklearn-color-fitted-level-0: #f0f8ff;\n",
              "  --sklearn-color-fitted-level-1: #d4ebff;\n",
              "  --sklearn-color-fitted-level-2: #b3dbfd;\n",
              "  --sklearn-color-fitted-level-3: cornflowerblue;\n",
              "\n",
              "  /* Specific color for light theme */\n",
              "  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n",
              "  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n",
              "  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n",
              "  --sklearn-color-icon: #696969;\n",
              "\n",
              "  @media (prefers-color-scheme: dark) {\n",
              "    /* Redefinition of color scheme for dark theme */\n",
              "    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n",
              "    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n",
              "    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n",
              "    --sklearn-color-icon: #878787;\n",
              "  }\n",
              "}\n",
              "\n",
              "#sk-container-id-1 {\n",
              "  color: var(--sklearn-color-text);\n",
              "}\n",
              "\n",
              "#sk-container-id-1 pre {\n",
              "  padding: 0;\n",
              "}\n",
              "\n",
              "#sk-container-id-1 input.sk-hidden--visually {\n",
              "  border: 0;\n",
              "  clip: rect(1px 1px 1px 1px);\n",
              "  clip: rect(1px, 1px, 1px, 1px);\n",
              "  height: 1px;\n",
              "  margin: -1px;\n",
              "  overflow: hidden;\n",
              "  padding: 0;\n",
              "  position: absolute;\n",
              "  width: 1px;\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-dashed-wrapped {\n",
              "  border: 1px dashed var(--sklearn-color-line);\n",
              "  margin: 0 0.4em 0.5em 0.4em;\n",
              "  box-sizing: border-box;\n",
              "  padding-bottom: 0.4em;\n",
              "  background-color: var(--sklearn-color-background);\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-container {\n",
              "  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n",
              "     but bootstrap.min.css set `[hidden] { display: none !important; }`\n",
              "     so we also need the `!important` here to be able to override the\n",
              "     default hidden behavior on the sphinx rendered scikit-learn.org.\n",
              "     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n",
              "  display: inline-block !important;\n",
              "  position: relative;\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-text-repr-fallback {\n",
              "  display: none;\n",
              "}\n",
              "\n",
              "div.sk-parallel-item,\n",
              "div.sk-serial,\n",
              "div.sk-item {\n",
              "  /* draw centered vertical line to link estimators */\n",
              "  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n",
              "  background-size: 2px 100%;\n",
              "  background-repeat: no-repeat;\n",
              "  background-position: center center;\n",
              "}\n",
              "\n",
              "/* Parallel-specific style estimator block */\n",
              "\n",
              "#sk-container-id-1 div.sk-parallel-item::after {\n",
              "  content: \"\";\n",
              "  width: 100%;\n",
              "  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n",
              "  flex-grow: 1;\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-parallel {\n",
              "  display: flex;\n",
              "  align-items: stretch;\n",
              "  justify-content: center;\n",
              "  background-color: var(--sklearn-color-background);\n",
              "  position: relative;\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-parallel-item {\n",
              "  display: flex;\n",
              "  flex-direction: column;\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-parallel-item:first-child::after {\n",
              "  align-self: flex-end;\n",
              "  width: 50%;\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-parallel-item:last-child::after {\n",
              "  align-self: flex-start;\n",
              "  width: 50%;\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-parallel-item:only-child::after {\n",
              "  width: 0;\n",
              "}\n",
              "\n",
              "/* Serial-specific style estimator block */\n",
              "\n",
              "#sk-container-id-1 div.sk-serial {\n",
              "  display: flex;\n",
              "  flex-direction: column;\n",
              "  align-items: center;\n",
              "  background-color: var(--sklearn-color-background);\n",
              "  padding-right: 1em;\n",
              "  padding-left: 1em;\n",
              "}\n",
              "\n",
              "\n",
              "/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\n",
              "clickable and can be expanded/collapsed.\n",
              "- Pipeline and ColumnTransformer use this feature and define the default style\n",
              "- Estimators will overwrite some part of the style using the `sk-estimator` class\n",
              "*/\n",
              "\n",
              "/* Pipeline and ColumnTransformer style (default) */\n",
              "\n",
              "#sk-container-id-1 div.sk-toggleable {\n",
              "  /* Default theme specific background. It is overwritten whether we have a\n",
              "  specific estimator or a Pipeline/ColumnTransformer */\n",
              "  background-color: var(--sklearn-color-background);\n",
              "}\n",
              "\n",
              "/* Toggleable label */\n",
              "#sk-container-id-1 label.sk-toggleable__label {\n",
              "  cursor: pointer;\n",
              "  display: flex;\n",
              "  width: 100%;\n",
              "  margin-bottom: 0;\n",
              "  padding: 0.5em;\n",
              "  box-sizing: border-box;\n",
              "  text-align: center;\n",
              "  align-items: start;\n",
              "  justify-content: space-between;\n",
              "  gap: 0.5em;\n",
              "}\n",
              "\n",
              "#sk-container-id-1 label.sk-toggleable__label .caption {\n",
              "  font-size: 0.6rem;\n",
              "  font-weight: lighter;\n",
              "  color: var(--sklearn-color-text-muted);\n",
              "}\n",
              "\n",
              "#sk-container-id-1 label.sk-toggleable__label-arrow:before {\n",
              "  /* Arrow on the left of the label */\n",
              "  content: \"▸\";\n",
              "  float: left;\n",
              "  margin-right: 0.25em;\n",
              "  color: var(--sklearn-color-icon);\n",
              "}\n",
              "\n",
              "#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {\n",
              "  color: var(--sklearn-color-text);\n",
              "}\n",
              "\n",
              "/* Toggleable content - dropdown */\n",
              "\n",
              "#sk-container-id-1 div.sk-toggleable__content {\n",
              "  max-height: 0;\n",
              "  max-width: 0;\n",
              "  overflow: hidden;\n",
              "  text-align: left;\n",
              "  /* unfitted */\n",
              "  background-color: var(--sklearn-color-unfitted-level-0);\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-toggleable__content.fitted {\n",
              "  /* fitted */\n",
              "  background-color: var(--sklearn-color-fitted-level-0);\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-toggleable__content pre {\n",
              "  margin: 0.2em;\n",
              "  border-radius: 0.25em;\n",
              "  color: var(--sklearn-color-text);\n",
              "  /* unfitted */\n",
              "  background-color: var(--sklearn-color-unfitted-level-0);\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-toggleable__content.fitted pre {\n",
              "  /* unfitted */\n",
              "  background-color: var(--sklearn-color-fitted-level-0);\n",
              "}\n",
              "\n",
              "#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n",
              "  /* Expand drop-down */\n",
              "  max-height: 200px;\n",
              "  max-width: 100%;\n",
              "  overflow: auto;\n",
              "}\n",
              "\n",
              "#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n",
              "  content: \"▾\";\n",
              "}\n",
              "\n",
              "/* Pipeline/ColumnTransformer-specific style */\n",
              "\n",
              "#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
              "  color: var(--sklearn-color-text);\n",
              "  background-color: var(--sklearn-color-unfitted-level-2);\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
              "  background-color: var(--sklearn-color-fitted-level-2);\n",
              "}\n",
              "\n",
              "/* Estimator-specific style */\n",
              "\n",
              "/* Colorize estimator box */\n",
              "#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
              "  /* unfitted */\n",
              "  background-color: var(--sklearn-color-unfitted-level-2);\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
              "  /* fitted */\n",
              "  background-color: var(--sklearn-color-fitted-level-2);\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-label label.sk-toggleable__label,\n",
              "#sk-container-id-1 div.sk-label label {\n",
              "  /* The background is the default theme color */\n",
              "  color: var(--sklearn-color-text-on-default-background);\n",
              "}\n",
              "\n",
              "/* On hover, darken the color of the background */\n",
              "#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {\n",
              "  color: var(--sklearn-color-text);\n",
              "  background-color: var(--sklearn-color-unfitted-level-2);\n",
              "}\n",
              "\n",
              "/* Label box, darken color on hover, fitted */\n",
              "#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n",
              "  color: var(--sklearn-color-text);\n",
              "  background-color: var(--sklearn-color-fitted-level-2);\n",
              "}\n",
              "\n",
              "/* Estimator label */\n",
              "\n",
              "#sk-container-id-1 div.sk-label label {\n",
              "  font-family: monospace;\n",
              "  font-weight: bold;\n",
              "  display: inline-block;\n",
              "  line-height: 1.2em;\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-label-container {\n",
              "  text-align: center;\n",
              "}\n",
              "\n",
              "/* Estimator-specific */\n",
              "#sk-container-id-1 div.sk-estimator {\n",
              "  font-family: monospace;\n",
              "  border: 1px dotted var(--sklearn-color-border-box);\n",
              "  border-radius: 0.25em;\n",
              "  box-sizing: border-box;\n",
              "  margin-bottom: 0.5em;\n",
              "  /* unfitted */\n",
              "  background-color: var(--sklearn-color-unfitted-level-0);\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-estimator.fitted {\n",
              "  /* fitted */\n",
              "  background-color: var(--sklearn-color-fitted-level-0);\n",
              "}\n",
              "\n",
              "/* on hover */\n",
              "#sk-container-id-1 div.sk-estimator:hover {\n",
              "  /* unfitted */\n",
              "  background-color: var(--sklearn-color-unfitted-level-2);\n",
              "}\n",
              "\n",
              "#sk-container-id-1 div.sk-estimator.fitted:hover {\n",
              "  /* fitted */\n",
              "  background-color: var(--sklearn-color-fitted-level-2);\n",
              "}\n",
              "\n",
              "/* Specification for estimator info (e.g. \"i\" and \"?\") */\n",
              "\n",
              "/* Common style for \"i\" and \"?\" */\n",
              "\n",
              ".sk-estimator-doc-link,\n",
              "a:link.sk-estimator-doc-link,\n",
              "a:visited.sk-estimator-doc-link {\n",
              "  float: right;\n",
              "  font-size: smaller;\n",
              "  line-height: 1em;\n",
              "  font-family: monospace;\n",
              "  background-color: var(--sklearn-color-background);\n",
              "  border-radius: 1em;\n",
              "  height: 1em;\n",
              "  width: 1em;\n",
              "  text-decoration: none !important;\n",
              "  margin-left: 0.5em;\n",
              "  text-align: center;\n",
              "  /* unfitted */\n",
              "  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n",
              "  color: var(--sklearn-color-unfitted-level-1);\n",
              "}\n",
              "\n",
              ".sk-estimator-doc-link.fitted,\n",
              "a:link.sk-estimator-doc-link.fitted,\n",
              "a:visited.sk-estimator-doc-link.fitted {\n",
              "  /* fitted */\n",
              "  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n",
              "  color: var(--sklearn-color-fitted-level-1);\n",
              "}\n",
              "\n",
              "/* On hover */\n",
              "div.sk-estimator:hover .sk-estimator-doc-link:hover,\n",
              ".sk-estimator-doc-link:hover,\n",
              "div.sk-label-container:hover .sk-estimator-doc-link:hover,\n",
              ".sk-estimator-doc-link:hover {\n",
              "  /* unfitted */\n",
              "  background-color: var(--sklearn-color-unfitted-level-3);\n",
              "  color: var(--sklearn-color-background);\n",
              "  text-decoration: none;\n",
              "}\n",
              "\n",
              "div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n",
              ".sk-estimator-doc-link.fitted:hover,\n",
              "div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n",
              ".sk-estimator-doc-link.fitted:hover {\n",
              "  /* fitted */\n",
              "  background-color: var(--sklearn-color-fitted-level-3);\n",
              "  color: var(--sklearn-color-background);\n",
              "  text-decoration: none;\n",
              "}\n",
              "\n",
              "/* Span, style for the box shown on hovering the info icon */\n",
              ".sk-estimator-doc-link span {\n",
              "  display: none;\n",
              "  z-index: 9999;\n",
              "  position: relative;\n",
              "  font-weight: normal;\n",
              "  right: .2ex;\n",
              "  padding: .5ex;\n",
              "  margin: .5ex;\n",
              "  width: min-content;\n",
              "  min-width: 20ex;\n",
              "  max-width: 50ex;\n",
              "  color: var(--sklearn-color-text);\n",
              "  box-shadow: 2pt 2pt 4pt #999;\n",
              "  /* unfitted */\n",
              "  background: var(--sklearn-color-unfitted-level-0);\n",
              "  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n",
              "}\n",
              "\n",
              ".sk-estimator-doc-link.fitted span {\n",
              "  /* fitted */\n",
              "  background: var(--sklearn-color-fitted-level-0);\n",
              "  border: var(--sklearn-color-fitted-level-3);\n",
              "}\n",
              "\n",
              ".sk-estimator-doc-link:hover span {\n",
              "  display: block;\n",
              "}\n",
              "\n",
              "/* \"?\"-specific style due to the `<a>` HTML tag */\n",
              "\n",
              "#sk-container-id-1 a.estimator_doc_link {\n",
              "  float: right;\n",
              "  font-size: 1rem;\n",
              "  line-height: 1em;\n",
              "  font-family: monospace;\n",
              "  background-color: var(--sklearn-color-background);\n",
              "  border-radius: 1rem;\n",
              "  height: 1rem;\n",
              "  width: 1rem;\n",
              "  text-decoration: none;\n",
              "  /* unfitted */\n",
              "  color: var(--sklearn-color-unfitted-level-1);\n",
              "  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n",
              "}\n",
              "\n",
              "#sk-container-id-1 a.estimator_doc_link.fitted {\n",
              "  /* fitted */\n",
              "  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n",
              "  color: var(--sklearn-color-fitted-level-1);\n",
              "}\n",
              "\n",
              "/* On hover */\n",
              "#sk-container-id-1 a.estimator_doc_link:hover {\n",
              "  /* unfitted */\n",
              "  background-color: var(--sklearn-color-unfitted-level-3);\n",
              "  color: var(--sklearn-color-background);\n",
              "  text-decoration: none;\n",
              "}\n",
              "\n",
              "#sk-container-id-1 a.estimator_doc_link.fitted:hover {\n",
              "  /* fitted */\n",
              "  background-color: var(--sklearn-color-fitted-level-3);\n",
              "}\n",
              "</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>LogisticRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>LogisticRegression</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.linear_model.LogisticRegression.html\">?<span>Documentation for LogisticRegression</span></a><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></div></label><div class=\"sk-toggleable__content fitted\"><pre>LogisticRegression()</pre></div> </div></div></div></div>"
            ]
          },
          "metadata": {},
          "execution_count": 14
        }
      ],
      "source": [
        "from sklearn.preprocessing import LabelEncoder, StandardScaler\n",
        "from sklearn.model_selection import train_test_split\n",
        "from sklearn.linear_model import LogisticRegression\n",
        "from sklearn.metrics import accuracy_score\n",
        "\n",
        "# ... (your previous code for loading and initial cleaning) ...\n",
        "\n",
        "# 1. Convert 'TotalCharges' to numeric\n",
        "df['TotalCharges'] = pd.to_numeric(df['TotalCharges'], errors='coerce')\n",
        "\n",
        "# 2. One-hot encode or Label Encode all categorical columns\n",
        "# Get a list of all categorical columns before any transformations\n",
        "all_categorical_cols = df.select_dtypes(include=['object']).columns.tolist()\n",
        "# Remove columns that have already been encoded\n",
        "categorical_cols = [col for col in all_categorical_cols if col not in ['gender', 'Partner', 'Dependents']]\n",
        "\n",
        "# Choose either Label Encoding or One-Hot Encoding\n",
        "encoding_method = 'one-hot'  # or 'label'\n",
        "\n",
        "if encoding_method == 'one-hot':\n",
        "    df = pd.get_dummies(df, columns=categorical_cols, drop_first=True)\n",
        "elif encoding_method == 'label':\n",
        "    label_encoder = LabelEncoder()\n",
        "    for col in categorical_cols:\n",
        "        df[col] = label_encoder.fit_transform(df[col])\n",
        "\n",
        "# 3. Scale numerical features\n",
        "numerical_cols = ['tenure', 'MonthlyCharges', 'TotalCharges']\n",
        "scaler = StandardScaler()\n",
        "df[numerical_cols] = scaler.fit_transform(df[numerical_cols])\n",
        "\n",
        "# 4. Split data into training and testing sets\n",
        "customerID_col = next((col for col in df.columns if col.startswith('customerID')), 'customerID')\n",
        "target_col = 'Churn_Yes' if 'Churn_Yes' in df.columns else 'Churn'\n",
        "X = df.drop(columns=[customerID_col, target_col])  # Drop target column as well\n",
        "y = df[target_col]\n",
        "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n",
        "\n",
        "# 5. Train the model\n",
        "model = LogisticRegression()\n",
        "model.fit(X_train, y_train)\n",
        "\n",
        "# ... (rest of your code) ..."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 15,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "A7SIzCEDoxJc",
        "outputId": "4854c104-2feb-4233-8de2-d24716762700"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "LogisticRegressionAccuracy: 0.8218594748048261\n"
          ]
        }
      ],
      "source": [
        "# ... (your previous code including imputation or dropping NaNs) ...\n",
        "\n",
        "# 5. Train the model\n",
        "model = LogisticRegression()\n",
        "model.fit(X_train, y_train)\n",
        "\n",
        "# 6. Make predictions\n",
        "y_pred = model.predict(X_test)\n",
        "\n",
        "# 7. Evaluate the model\n",
        "accuracy = accuracy_score(y_test, y_pred)\n",
        "print(f\"LogisticRegressionAccuracy: {accuracy}\")\n",
        "\n",
        "# 8. Further analysis and improvements (optional)\n",
        "#   - Explore other classification models (e.g., Random Forest, SVM)\n",
        "#   - Perform hyperparameter tuning using GridSearchCV or RandomizedSearchCV\n",
        "#   - Analyze feature importance to understand which features are most predictive\n",
        "#   - Consider using cross-validation for more robust evaluation\n",
        "#   - Implement techniques to address class imbalance if present"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 16,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "XUHc12VtpPAX",
        "outputId": "8a93864f-a9e0-4ca9-f4ca-1c3c0cc6472c"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Random Forest Accuracy: 0.7963094393186657\n"
          ]
        }
      ],
      "source": [
        "from sklearn.ensemble import RandomForestClassifier\n",
        "\n",
        "# 1. Create a Random Forest Classifier object\n",
        "rf_model = RandomForestClassifier(random_state=42) # You can adjust hyperparameters here\n",
        "\n",
        "# 2. Train the model on the training data\n",
        "rf_model.fit(X_train, y_train)\n",
        "\n",
        "# 3. Make predictions on the test data\n",
        "y_pred_rf = rf_model.predict(X_test)\n",
        "\n",
        "# 4. Evaluate the model's accuracy\n",
        "accuracy_rf = accuracy_score(y_test, y_pred_rf)\n",
        "print(f\"Random Forest Accuracy: {accuracy_rf}\")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true
        },
        "id": "QewEqjyTp2uV"
      },
      "outputs": [],
      "source": [
        "from sklearn.model_selection import GridSearchCV\n",
        "from sklearn.ensemble import RandomForestClassifier\n",
        "\n",
        "# Define the parameter grid to search\n",
        "param_grid = {\n",
        "    'n_estimators': [100, 200, 300],\n",
        "    'max_depth': [None, 10, 20, 30],\n",
        "    'min_samples_split': [2, 5, 10],\n",
        "    'min_samples_leaf': [1, 2, 4]\n",
        "}\n",
        "\n",
        "# Create GridSearchCV object\n",
        "grid_search = GridSearchCV(RandomForestClassifier(random_state=42), param_grid, cv=5, scoring='accuracy')\n",
        "\n",
        "# Fit the grid search to the training data\n",
        "grid_search.fit(X_train, y_train)\n",
        "\n",
        "# Get the best model and its accuracy\n",
        "best_rf_model = grid_search.best_estimator_\n",
        "best_rf_accuracy = grid_search.best_score_\n",
        "\n",
        "print(f\"Best Random Forest Model: {best_rf_model}\")\n",
        "print(f\"Best Random Forest Accuracy: {best_rf_accuracy}\")\n",
        "\n",
        "# Evaluate on the test set\n",
        "y_pred_best_rf = best_rf_model.predict(X_test)\n",
        "accuracy_best_rf = accuracy_score(y_test, y_pred_best_rf)\n",
        "print(f\"Accuracy on Test Set (Best Random Forest): {accuracy_best_rf}\")"
      ]
    }
  ],
  "metadata": {
    "colab": {
      "provenance": [],
      "authorship_tag": "ABX9TyOj2VreYjFY+5M19g9xcgFW",
      "include_colab_link": true
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "name": "python"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}